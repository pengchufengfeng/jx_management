(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c8ff4aa6"],{"143b":function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("Card",[o("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n       "+t._s(t.id?"编辑销售":"添加销售")+"\n    ")]),o("Form",{attrs:{model:t.content,"label-width":120}},[o("FormItem",{attrs:{label:"商品名称"}},[o("Select",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入商品编号","label-in-value":!0},on:{"on-change":t.chooseCommodity},model:{value:t.content.commodityName,callback:function(e){t.$set(t.content,"commodityName",e)},expression:"content.commodityName"}},t._l(t.commodityList,function(e,n){return o("Option",{key:n,attrs:{ids:e.id,value:e.name}},[t._v(t._s(e.name))])}))],1),o("FormItem",{attrs:{label:"商品编号"}},[o("Input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入商品编号"},model:{value:t.content.commodityNum,callback:function(e){t.$set(t.content,"commodityNum",e)},expression:"content.commodityNum"}})],1),o("FormItem",{attrs:{label:"匠人"}},[o("Input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入销售平台"},model:{value:t.content.artistName,callback:function(e){t.$set(t.content,"artistName",e)},expression:"content.artistName"}})],1),o("FormItem",{attrs:{label:"销售平台"}},[o("Select",{staticStyle:{width:"400px"},attrs:{placeholder:"请选择平台","label-in-value":!0},on:{"on-change":t.choosePlatform},model:{value:t.content.platId,callback:function(e){t.$set(t.content,"platId",e)},expression:"content.platId"}},t._l(t.platformList,function(e,n){return o("Option",{key:n,attrs:{ids:e.id,value:e.id}},[t._v(t._s(e.name))])}))],1),o("FormItem",{attrs:{label:"销售类型"}},[o("Select",{staticStyle:{width:"400px"},attrs:{placeholder:"请选择销售类型","label-in-value":!0},on:{"on-change":t.chooseWayform},model:{value:t.content.saleWay,callback:function(e){t.$set(t.content,"saleWay",e)},expression:"content.saleWay"}},t._l(t.activityNameList,function(e,n){return o("Option",{key:n,attrs:{ids:e.id,value:e.id}},[t._v(t._s(e.name))])}))],1),o("FormItem",{attrs:{label:"商品单价"}},[o("Input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入商品单价"},model:{value:t.content.prePrice,callback:function(e){t.$set(t.content,"prePrice",e)},expression:"content.prePrice"}})],1),o("FormItem",{attrs:{label:"商品销售量"}},[o("Input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入商品销售量"},model:{value:t.content.commodityAmount,callback:function(e){t.$set(t.content,"commodityAmount",e)},expression:"content.commodityAmount"}})],1),o("FormItem",{attrs:{label:"商品销售额"}},[o("Input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入商品销售额",readonly:""},model:{value:t.content.prePrice*t.content.commodityAmount,callback:function(e){t.$set(t.content.prePrice*t.content,"commodityAmount",e)},expression:"content.prePrice*content.commodityAmount"}})],1),o("FormItem",{attrs:{label:"退款额"}},[o("Input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入退款额"},model:{value:t.content.saleBackPrice,callback:function(e){t.$set(t.content,"saleBackPrice",e)},expression:"content.saleBackPrice"}})],1),o("FormItem",{attrs:{label:"实际销售额"}},[o("Input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入实际销售额",readonly:""},model:{value:t.content.prePrice*t.content.commodityAmount-t.content.saleBackPrice,callback:function(e){t.$set(t.content.prePrice*t.content.commodityAmount-t.content,"saleBackPrice",e)},expression:"content.prePrice*content.commodityAmount-content.saleBackPrice"}})],1),o("FormItem",{attrs:{label:"销售日期"}},[o("DatePicker",{staticStyle:{width:"400px"},attrs:{value:t.content.saleDate,type:"datetime",format:"yyyy-MM-dd",placement:"bottom-start",placeholder:"选择销售时间"},on:{"on-change":t.getSaleDate}})],1),o("FormItem",{attrs:{label:"销售状态"}},[o("Select",{staticStyle:{width:"400px"},attrs:{placeholder:"请选择销售状态"},model:{value:t.content.saleStatus,callback:function(e){t.$set(t.content,"saleStatus",e)},expression:"content.saleStatus"}},t._l(t.statusList,function(e,n){return o("Option",{key:n,attrs:{value:e}},[t._v(t._s(e))])}))],1),o("div",{staticClass:"btn"},[o("Button",{staticStyle:{width:"120px"},attrs:{type:"primary",loading:t.loading,size:"large"},on:{click:t.submit}},[t.loading?o("span",[t._v("Loading...")]):o("span",[t._v("提交")])])],1)],1)],1)},a=[],i=(o("7f7f"),o("20d6"),o("ac6a"),o("8615"),{data:function(){return{content:{commodityNum:"",wayName:"",saleStyle:"",prePrice:"",commodityAmount:"",salePrice:0,saleBackPrice:0,saleFactPrice:0,finalPrice:0,artistFinalPrice:0,saleFinalPrice:0,platRate:0,artistRate:0,updateDate:"",artistName:"",commodityName:"",saleWay:"",commodityId:"",platName:"",platId:"",saleStatus:""},id:"",loading:!1,activityNameList:[],artistList:[],platformList:[],commodityList:[],statusList:["已完成销售","已退款退货","已部分退款"]}},created:function(){this.id=this.$route.query.id,this.getArtistList(),this.getPlatfromList(),this.getCommodity(),this.getWayfromList(),this.id&&this.init()},methods:{init:function(){var t=this,e={id:this.id};this.$axios({method:"post",url:"/sale/getOneByJx",data:this.$qs.stringify(e),headers:{Authorization:window.localStorage.getItem("token")}}).then(function(e){var o=e.data;console.log(o),1==o.code?(t.content=o.data,t.getWayfromList()):t.$Notice.warning({title:o.msg})})},getSaleDate:function(t){this.content.saleDate=t},add:function(){var t=this;this.content.salePrice=this.content.prePrice*this.content.commodityAmount,this.content.saleFactPrice=this.content.salePrice-this.content.saleBackPrice,this.$axios({method:"post",url:"/sale/addOne",data:this.content,headers:{"content-type":"application/json; charset=UTF-8",Authorization:window.localStorage.getItem("token")}}).then(function(e){console.log(t.content),t.loading=!1;var o=e.data;console.log(o),1==o.code?t.$router.push({name:"sales-list"}):t.$Notice.warning({title:o.msg})}).then(function(e){t.loading=!1})},edit:function(){var t=this;this.content.id=this.id,this.content.salePrice=this.content.prePrice*this.content.commodityAmount,this.content.saleFactPrice=this.content.salePrice-this.content.saleBackPrice,console.log(this.content),this.$axios({method:"post",url:"/sale/updateOne",data:this.content,headers:{"content-type":"application/json; charset=UTF-8",Authorization:window.localStorage.getItem("token")}}).then(function(e){console.log(t.content),t.loading=!1;var o=e.data;1==o.code?t.$router.push({name:"sales-list"}):t.$Notice.warning({title:o.msg})}).then(function(e){t.loading=!1})},submit:function(){0!=Object.values(this.content).length?(this.loading=!0,this.id?this.edit():this.add()):this.$Notice.warning({title:"请输入数据"})},getArtistList:function(){var t=this;this.$axios({method:"post",url:"/artist/findAllList",headers:{Authorization:window.localStorage.getItem("token")}}).then(function(e){console.log(e);var o=e.data;1==o.code?o.data.forEach(function(e,o){var n={id:e.id,name:e.artistName};console.log(e),t.artistList.push(n)}):t.$Notice.warning({title:o.msg})})},getPlatfromList:function(){var t=this;this.$axios({method:"post",url:"/plat/findAllList",headers:{Authorization:window.localStorage.getItem("token")}}).then(function(e){var o=e.data;1==o.code?o.data.forEach(function(e,o){var n={id:e.id,name:e.wayName};t.platformList.push(n)}):t.$Notice.warning({title:o.msg})})},getWayfromList:function(){var t=this,e=(this.content.platId,{platId:this.content.platId});this.$axios({method:"post",url:"/platDetail/findAllActivity",data:this.$qs.stringify(e),headers:{Authorization:window.localStorage.getItem("token")}}).then(function(e){var o=e.data;t.activityNameList=[],1==o.code?o.data.forEach(function(e,o){var n={id:e.id,name:e.activityName};t.activityNameList.push(n)}):t.$Notice.warning({title:o.msg})})},getCommodity:function(){var t=this;this.$axios({method:"post",url:"/commodity/findAllList",headers:{Authorization:window.localStorage.getItem("token")}}).then(function(e){var o=e.data;console.log(o),1==o.code?(console.log(o.data),o.data.forEach(function(e,o){var n={id:e.id,name:e.commodityName,num:e.commodityNum};t.commodityList.push(n)})):t.$Notice.warning({title:o.msg})})},chooseArtist:function(t){this.content.artistName=t.label,this.content.artistid=t.value},chooseCommodity:function(t){console.log(t),console.log(this.commodityList);var e=this.commodityList.findIndex(function(e){return e.name===t.value});-1!==e&&(this.content.commodityNum=this.commodityList[e].num,this.content.commodityId=this.commodityList[e].id,this.content.artistName=this.commodityList[e].artistName),this.content.id=t.id,console.log(t)},choosePlatform:function(t){this.content.wayName=t.label,this.content.platId=t.value,this.getWayfromList(),console.log(t)},chooseWayform:function(t){this.content.saleStyle=t.label,this.content.saleWay=t.value,console.log(t)}}}),c=i,s=(o("a655"),o("2877")),l=Object(s["a"])(c,n,a,!1,null,null,null);l.options.__file="SalesEdit.vue";e["default"]=l.exports},"1aa4":function(t,e,o){},"504c":function(t,e,o){var n=o("0d58"),a=o("6821"),i=o("52a7").f;t.exports=function(t){return function(e){var o,c=a(e),s=n(c),l=s.length,r=0,m=[];while(l>r)i.call(c,o=s[r++])&&m.push(t?[o,c[o]]:c[o]);return m}}},8615:function(t,e,o){var n=o("5ca1"),a=o("504c")(!1);n(n.S,"Object",{values:function(t){return a(t)}})},a655:function(t,e,o){"use strict";var n=o("1aa4"),a=o.n(n);a.a}}]);